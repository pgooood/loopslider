/**
 * LoopSlider
 * @version 0.1
 * @author Pavel Khoroshkov aka pgood
 * @link https://github.com/pgooood/loopslider
 */
!function(t){t.fn.loopslider=function(e){function n(n){var i={$e:t(e.htmlSliderBody).appendTo(t(e.htmlSliderWraper).width("100%")).width("1000%"),$items:function(){return this.$e.find(">*")},$currentItem:function(){return this.$e.find(">*:first-child")},currentIndex:function(){return this.$currentItem().data("index")}};return n.find(">*").each(function(n){t(e.htmlItemWraper).append(this).appendTo(i.$e).data("index",n)}),n.append(i.$e.parent()),i.length=i.$items().length,i}function i(n){var i=n.$e.parent().width();n.itemWidth=(i-e.gap*(e.visibleItems-1))/e.visibleItems,n.arInvisible&&n.arInvisible.length&&n.$e.append(n.arInvisible),n.arInvisible=[];var a=n.$items();return a.css({"margin-right":((e.gap>0?100*e.gap/i:0)/10).toFixed(3)+"%",width:(100*n.itemWidth/i/10).toFixed(3)+"%"}),(n.enabled=n.length>e.visibleItems)&&(a.each(function(t,i){t>=e.visibleItems&&n.arInvisible.push(i)}),t(n.arInvisible).detach()),n}function a(){t(m).each(function(){var n=this,i=Math.ceil(n.length/e.visibleItems),a=t(e.htmlPaginationContainer);if(n.$pagination&&n.$pagination.parent().remove(),!n.enabled)return!0;for(var o=0;i>o;o++)t(e.htmlPaginationItem).appendTo(a).addClass("loopslider-page-nav-item").click(function(t){return function(){u(t*e.visibleItems)}}(o));a.insertAfter(n.$e.parent()),n.$pagination=a.find(">.loopslider-page-nav-item"),s(n)})}function o(e,n){t("#loopslider-sprite").length||t("body").get(0).insertAdjacentHTML("afterbegin",'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="loopslider-sprite" style="display:none"><symbol id="loopslider-prev-icon" viewBox="0 0 50 50"><path d="M27.3 34.7L17.6 25l9.7-9.7 1.4 1.4-8.3 8.3 8.3 8.3z"/></symbol><symbol id="loopslider-next-icon" viewBox="0 0 50 50"><path d="M22.7 34.7l-1.4-1.4 8.3-8.3-8.3-8.3 1.4-1.4 9.7 9.7z"/></symbol></svg>');var i=window.location.pathname+window.location.search+"#loopslider-"+e+"-icon";return $e=t('<div class="loopslider-nav-button loopslider-'+e+'-button"></div>'),$e.appendTo(n).get(0).insertAdjacentHTML("afterbegin",'<svg><use xlink:href="'+i+'"/></svg>'),$e}function r(){t(m).each(function(){var t=this,e=function(){var e=t.$e.parent().height()/2;t.prevButton.css("top",e-t.prevButton.height()/2),t.nextButton.css("top",e-t.nextButton.height()/2)};t.prevButton||(t.prevButton=o("prev",t.$e.parent()).click(function(){l()})),this.nextButton||(this.nextButton=o("next",t.$e.parent()).click(function(){p()})),e(),t.$e.find("img").load(e)})}function s(t){t.$pagination&&(t.$pagination.removeClass("loopslider-active"),t.$pagination.eq(Math.round(t.currentIndex()/e.visibleItems)).addClass("loopslider-active"))}function l(n){return n=n||e.step,t(m).each(function(){var i,a=this;if(a.enabled&&!a.motion){d(),a.motion=!0;for(var o=0;n>o;o++)t(a.arInvisible.pop()).prependTo(a.$e);a.$e.css("left",(a.itemWidth+e.gap)*-n),a.$e.animate({left:0},e.slideDuration,e.easing,function(){for(var t=0;n>t;t++)i=a.$items(),a.arInvisible.unshift(i.get(i.length-1)),i.eq(i.length-1).detach();a.motion=!1,s(a),g&&c(),"function"==typeof e.onMove&&e.onMove(a.currentIndex(),a.$currentItem().find(">*:first-child"),"backward")})}}),!1}function p(n){return n=n||e.step,t(m).each(function(){var i,a=this;if(a.enabled&&!a.motion){d(),a.motion=!0;for(var o=0;n>o;o++)t(a.arInvisible.shift()).appendTo(a.$e);a.$e.animate({left:(a.itemWidth+e.gap)*-n},e.slideDuration,e.easing,function(){for(var t=0;n>t;t++)i=a.$items(),a.arInvisible.push(i.get(0)),i.eq(0).detach();a.$e.css("left",0),a.motion=!1,s(a),g&&c(),"function"==typeof e.onMove&&e.onMove(a.currentIndex(),a.$currentItem().find(">*:first-child"),"forward")})}}),!1}function u(e){e=parseInt(e),isNaN(e)||t(m).each(function(){var t=this,n=t.$currentItem().data("index"),i=e-n,a=t.length-n+e,o=t.length-e+n;return e>=t.length||e==n?!0:void(Math.abs(i)<a&&Math.abs(i)<o?i>0?p(i):l(Math.abs(i)):o>a?p(a):l(o))})}function c(){d(),t(m).each(function(){var t=this;t.enabled&&e.autoplayInterval>e.slideDuration&&(t.autoplayIntervalId=window.setInterval(function(){p()},e.autoplayInterval))})}function d(){t(m).each(function(){var t=this;t.autoplayIntervalId&&(window.clearInterval(t.autoplayIntervalId),t.autoplayIntervalId=null)})}function v(){c(),g=!0,"function"==typeof e.onPlay&&e.onPlay()}function h(){t(m).each(function(){var t,e,n,i=this.$e.get(0),a=100,o=1e3;i.addEventListener&&(i.addEventListener("touchstart",function(i){var a=i.changedTouches[0];t=a.pageX,e=a.pageY,n=(new Date).getTime()},!1),i.addEventListener("touchend",function(i){var r=i.changedTouches[0],s=(new Date).getTime()-n,u=Math.abs(r.pageX-t);o>=s&&u>=a&&u>=Math.abs(r.pageY-e)&&(r.pageX-t>0?l():p())},!1))})}function f(){if(d(),t(m).each(function(){this.$e.stop(!0,!0)}),e.responsive){var n=parseInt(t(window).width()),o=Number.MAX_SAFE_INTEGER;for(var s in e.responsive)parseInt(s)>=n&&parseInt(s)<parseInt(o)&&(o=s);e.responsive[o]&&t.extend(e,e.responsive[o])}t(m).each(function(){i(this)}),e.navigation&&r(),e.pagination&&a(),g&&c()}e=t.extend({htmlSliderWraper:'<div class="loopslider"></div>',htmlSliderBody:'<div style="position:relative;"></div>',htmlItemWraper:'<div style="display:inline-block;"></div>',htmlPaginationContainer:'<div class="loopslider-pagination"></div>',htmlPaginationItem:"<div></div>",visibleItems:3,slideDuration:400,easing:"swing",responsive:!1,touchSupport:!0,autoplay:!1,stopOnHover:!1,autoplayInterval:3e3,prevButton:null,nextButton:null,stopButton:null,playButton:null,gap:0,step:1,pagination:!1,navigation:!1,onStop:null,onPlay:null,onMove:null},e),e.gap=parseInt(e.gap),e.gap=!isNaN(e.gap)&&e.gap>0?e.gap:0,e.visibleItems=e.visibleItems>0?parseInt(e.visibleItems):1,e.step=parseInt(e.step),e.step=isNaN(e.step)||e.step<1?1:e.step>e.visibleItems?e.visibleItems:e.step;var g,m=[];t(this).each(function(){m.push(n(t(this)))}),f(),t(window).resize(f),t(e.nextButton).click(function(){return p(),!1}),t(e.prevButton).click(function(){return l(),!1}),t(e.playButton).click(function(){return v(),!1}),t(e.stopButton).click(function(){return d(),g=!1,"function"==typeof e.onStop()&&e.onStop(),!1}),e.touchSupport&&h(),e.autoplay&&v(),e.stopOnHover&&(t(this).mouseenter(function(){g&&d()}),t(this).mouseleave(function(){g&&c()}))}}(jQuery);